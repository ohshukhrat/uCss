/**
 * @file Content Controller (formerly Reset)
 * @description Controls the global spacing variables defined in config/root.css.
 * 
 * Logic:
 * .cs (Content Spacing / App Mode): Sets all flow variables to 0. Use strictly for layout.
 * .csc (Content Spacing Child / Content Mode): Restores flow variables. Use for prose.
 * .cl (Clear List): Removes list styling.
 */

/**
 * @group Content Spacing (.cs) / App Mode
 * Disables all vertical rhythm.
 */
.cs {
    /* Kill Flow Variables */
    --flow-s: 0;
    --flow-xs: 0;
    --flow-l: 0;

    /* Kill Element Mappings */
    --p-flow: 0;
    --list-flow: 0;
    --li-flow: 0;
    --t-flow-s: 0;
    --t-flow-e: 0;

    /* Force Reset for stubborn agents */
    /* Note: We rely on variables in html.css, but this ensures hard resets */
    :where(h1, h2, h3, h4, h5, h6, p, ul, ol, li, dl, dt, dd, blockquote, figure, pre, code, kbd, samp, table) {
        margin-block: 0;
    }

    /* Form Elements Reset */
    :where(fieldset, legend) {
        margin: 0;
        padding: 0;
        border: 0;
    }

    /* List specific reset in App Mode */
    :where(ul, ol) {
        list-style: none;
        padding: 0;
    }

    style {
        display: none;
    }
}

/**
 * @group Content Spacing Child (.csc) / Content Mode
 * Restores vertical rhythm.
 */
.csc {
    /* Restore Defaults (from root.css) */
    /* We don't need to redeclare vars if they inherit from :root, 
       BUT .csc might be nested inside .cs which killed them. 
       So we must explicitly restore. */

    --flow-s: 1em;
    --flow-xs: 0.5em;
    --flow-l: 1.5em;

    --p-flow: var(--flow-s, 1em);
    --list-flow: var(--flow-s, 1em);
    --li-flow: var(--flow-xs, 0.5em);

    --t-flow-s: var(--flow-l, 1.5em);
    --t-flow-e: var(--flow-xs, 0.5em);
}

/* Allow nested resets again */
.csc .cs {
    --flow-s: 0;
    /* ...cascade will handle the rest via .cs selector spec... */
}

/**
 * @group Clear List (.cl)
 * Removes default list styling and margins.
 */
.cl {
    list-style: var(--cl-list-style, none);
    padding-inline: var(--cl-pi, 0);
    margin-inline: var(--cl-mi, 0);
    margin-block: var(--cl-mb, 0);
    --list-flow: 0;
    /* Integrate with new flow system */
}

/**
 * @group Reset Defaults
 * Normalizes blockquotes, figures, and figcaptions.

 */
.cs blockquote.cq {
    margin: 0;
    padding: 0;
    border: none;
}

.cs figure.cfg {
    display: var(--figure-d, grid);
    margin: 0;
    margin-block: 0;
    padding: 0;
    border: none;
}

.cs figcaption.cfgc {
    display: var(--figcaption-d, flex);
    margin: 0;
    margin-block: 0;
    padding: 0;
    border: none;
    text-align: var(--figcaption-ta);
}

/**
 * @group Utilities
 * Helper classes for display control.
 */
.cnt {
    display: contents
}