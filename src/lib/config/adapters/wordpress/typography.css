/**
 * @file WordPress Smart Flow and Typography Size Adapter
 * @description The vertical rhythm engine that manages spacing between flow elements.
 */

/* Typography Size */
body :is(h1, h2, h3, h4, h5, h6) {
    color: var(--t, currentColor);
    font-family: var(--t-font-fam, inherit);
    font-weight: var(--t-fw--m, 700);
    line-height: var(--t-lh, 1.1);
    text-wrap: var(--t-tw, balance);

    /* Remove default margins, handled by flow */
    margin: var(--heading-margin, 0);
}

body h1 {
    font-size: var(--heading-font-size, var(--h1-fs, var(--h-fs, var(--h-fs--xl, var(--t-fs, var(--t-fs--s, 2.625rem))))));
}

body h2 {
    font-size: var(--heading-font-size, var(--h2-fs, var(--h-fs, var(--h-fs--l, var(--t-fs, var(--t-fs--xs, 2.25rem))))));
}

body h3 {
    font-size: var(--heading-font-size, var(--h3-fs, var(--h-fs, var(--h-fs--m, var(--t-fs, var(--t-fs--xxs, 2rem))))));
}

body h4 {
    font-size: var(--heading-font-size, var(--h4-fs, var(--h-fs, var(--h-fs--s, var(--t-fs, var(--t-fs--xxxs, 1.75rem))))));
}

body h5 {
    font-size: var(--heading-font-size, var(--h5-fs, var(--h-fs, var(--h-fs--xs, var(--t-fs, var(--tx-fs--xxl, 1.625rem))))));
}

body h6 {
    font-size: var(--heading-font-size, var(--h6-fs, var(--h-fs, var(--h-fs--xxs, var(--t-fs, var(--tx-fs--xl, 1.4375rem))))));
}

/* Paragraphs & Text */
body p {
    font-size: var(--paragraph-font-size, var(--p-fs, var(--tx-fs, var(--tx-fs--s, 1rem))));
    margin-block: 0;
    max-width: var(--paragraph-max-width, var(--flow-max-w));
}

/*
 * Smart Flow
 */

/* 1. Standard Flow (Paragraphs, Lists) */
body :is(p, ul, ol, blockquote, figure, pre, table, form, image, video, iframe, canvas, div, a, h1, h2, h3, h4, h5, h6)+ :is(p, pre) {
    margin-top: var(--p-flow, .75em);
    margin-block-start: var(--p-flow, .75em);
    margin-bottom: var(--p-flow-e, 0);
    margin-block-end: var(--p-flow-e, 0);
}

body :is(p, ul, ol, blockquote, figure, pre, table, form, image, video, iframe, canvas, div, a, h1, h2, h3, h4, h5, h6)+ :is(ul, ol, blockquote, figure, pre, table) {
    margin-top: var(--el-flow, .75em);
    margin-block-start: var(--el-flow, 1.25em);
    margin-bottom: var(--el-flow-e, 0);
    margin-block-end: var(--el-flow-e, 0);
}

/* 2. Heading Flow */
/* Space BEFORE headings (if not first child) */
body :is(p, ul, ol, blockquote, figure, pre, table, form, image, video, iframe, canvas, div, a, h1, h2, h3, h4, h5, h6)+ :is(h1, h2, h3, h4, h5, h6) {
    margin-top: var(--t-flow-s, .75em);
    margin-block-start: var(--t-flow-s, 1em);
}

/* Space AFTER headings (connecting to text, or subtitle) */
body :is(h1, h2, h3, h4, h5, h6):not(:last-child) {
    margin-bottom: var(--t-flow-e, .375em);
    margin-block-end: var(--t-flow-e, .375em);
}

/* 3. List Item Flow */
body :is(li, a, div)+ :is(li) {
    margin-top: var(--li-flow, .5em);
    margin-block-start: var(--li-flow, .5em);
    margin-bottom: var(--li-flow-e, 0);
    margin-block-end: var(--li-flow-e, 0);
}

body :is(li, li > *)+ :is(ul, ol) {
    margin-top: var(--li-flow, .5em);
    margin-block-start: var(--li-flow, .5em);
    margin-bottom: var(--li-flow-e, 0);
    margin-block-end: var(--li-flow-e, 0);
}

/* 4. Button/Link After Flow */
body :is(p)+ :is(a, button, .btn) {
    margin-top: var(--p-flow, .75em);
    margin-block-start: var(--p-flow, .75em);
    margin-bottom: var(--p-flow-e, 0);
    margin-block-end: var(--p-flow-e, 0);
}

/* 5. Table Inner Flow */
body :is(div)> :is(table:only-child) {
    margin-top: var(--p-flow, .75em);
    margin-block-start: var(--p-flow, .75em);
    margin-bottom: var(--p-flow-e, 0);
    margin-block-end: var(--p-flow-e, 0);
}