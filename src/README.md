# Source Code

**Navigation**: [uCss](../) > [Source](./) > [Modules](./lib/) 

**Modules**: [Config](./lib/config/) | [Base](./lib/base/) | [Layout](./lib/layout/) | [Theming](./lib/theming/) | [Typography](./lib/typography/) | [Components](./lib/components/) | [Utilities](./lib/utilities/)

> **The Framework Core**. The `src` directory contains the uncompiled, commented source code for uCss. This is where you work if you are contributing to the framework or building a custom bundle.

---

## üìë Page Contents
*   [Architecture & Developer Guide](#-architecture--developer-guide)
*   [Core Pillars](#Ô∏è-core-pillars)
*   [Source Map](#-source-map)
*   [Deployment Stats](#-deployment-stats)
*   [The Manifest](#-the-manifest)
*   [Module Reference](#-module-reference)
*   [Maintainer Workflow](#Ô∏è-maintainer-workflow)
*   [Integration Snippets](#-integration-snippets)

---

## üìñ Architecture & Developer Guide

Welcome to the **uCss Technical Hub**. While the [Overview](../) introduces *what* uCss is, this document explains *how* it works and *why* it is built this way. This guide is intended for developers who want to understand the framework's internal logic, customize it deeply, or contribute to its source.

### The Philosophy: "Context is Everything"
Most CSS frameworks rely on **Media Queries** (screen size) to determine layout. uCss relies on **Container Queries** (context size).
*   **Old Way**: "If the screen is 768px wide, make this card 50% width."
*   **uCss Way**: "If I am inside a sidebar (small container), stack vertical. If I am in a main content area (wide container), go horizontal."

This shift makes components **truly portable**. You can place a Card, a Form, or a Grid anywhere‚Äîin a modal, a sidebar, or a hero section‚Äîand it will adapt to its *immediate parent* without you writing a single extra line of CSS.

---

## üèóÔ∏è Core Pillars

### 1. Variables as the Public API
In uCss, CSS Variables (Custom Properties) are not just for colors; they are the **primary interface** for controlling the framework.

*   **Global Scope (`root.css`)**: Defines the defaults.
    ```css
    :root { --p: hsl(43 100% 50%); /* Global Primary */ }
    ```
*   **Component Scope**: Components read these globals but can be overridden locally.
    ```css
    .btn { background: var(--btn-bg, var(--p)); }
    ```
*   **Cascade Injection**: You can theme a specific section by redefining variables on a parent.
    ```html
    <div style="--p: blue;">
       <button class="btn primary">I am Blue</button>
    </div>
    ```

### 2. The "Smart" Cascade
We organize our CSS to leverage the natural cascade rather than fighting it with `!important` or high specificity.
1.  **Config**: Sets the baseline.
2.  **Base**: Resets browser/cms quirks.
3.  **Layout**: Establishes the flow (Grid/Flex).
4.  **Components**: Adds visual style.
5.  **Utilities**: Overrides specific properties (highest specificity in practice due to proximity/class chaining).

### 3. Logical Properties
uCss is **Internationalization-Ready** out of the box. We strictly use [CSS Logical Properties](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Logical_Properties).
*   Left/Right ‚Üí `inline-start` / `inline-end`
*   Top/Bottom ‚Üí `block-start` / `block-end`
*   Width/Height ‚Üí `inline-size` / `block-size`

This means if you switch `dir="rtl"` on the `<html>` tag, the entire layout (margins, paddings, text-aligns, borders) flips automatically.

---

## üìÇ Source Map

The `src/` directory represents the **Development Environment**.

```text
src/
‚îú‚îÄ‚îÄ README.md           # This Architecture Guide
‚îú‚îÄ‚îÄ u.css               # The Manifest (orchestrates imports)
‚îî‚îÄ‚îÄ lib/                # The Modular Source Code
    ‚îú‚îÄ‚îÄ config/         # THE BRAIN: Design tokens, colors, scales
    ‚îú‚îÄ‚îÄ base/           # THE FOUNDATION: Resets & Normalizers
    ‚îú‚îÄ‚îÄ layout/         # THE SKELETON: Grid, Flex, Section
    ‚îú‚îÄ‚îÄ typography/     # THE VOICE: Fluid type scales
    ‚îú‚îÄ‚îÄ components/     # THE BODY: UI Elements (Cards, Buttons)
    ‚îú‚îÄ‚îÄ theming/        # THE SKIN: Contextual themes, overlays
    ‚îî‚îÄ‚îÄ utilities/      # THE TOOLS: Spacing helpers
```

### `src` vs `dist`
*   **`src/`**: Contains raw source files with heavy comments and individual `@import` statements.
*   **`dist/`**: Generated by the build system.
    *   **Bundle**: All imports resolved into flat files.
    *   **Clean**: Comments removed, nesting flattened (optional).
    *   **Min**: Compressed for production.
### `src` vs `dist`
*   **`src/`**: The "Source". Uncompiled, heavily commented, individual files. Contains raw source files with heavy comments and individual `@import` statements Use for development, or for reading and understanding the architecture.
*   **`dist/`**: The "Distribution" production-ready files adapting to the rollout structure and environment. Optimized, flattened, and compressed. Use for production.

### üì¶ Deployment Stats
The entire framework is surprisingly lightweight thanks to our optimization pipeline.

| File | Full | Clean | Min | Gzip | Brotli | Download |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **`u.css` (Full)** | ~165KB | ~147KB | ~126KB | ~18.4KB | ~14.3KB | [src](https://ucss.unqa.dev/stable/u.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/u.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/u.min.css) |
| **`config.css`** | ~21KB | ~12KB | ~11KB | ~2.5KB | ~2.1KB | [src](https://ucss.unqa.dev/stable/lib/config.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/config.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/config.min.css) |
| **`base.css`** | ~2.1KB | ~1.3KB | ~0.9KB | ~0.3KB | ~0.3KB | [src](https://ucss.unqa.dev/stable/lib/base.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/base.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/base.min.css) |
| **`layout.css`** | ~70KB | ~67KB | ~57KB | ~7.1KB | ~5.2KB | [src](https://ucss.unqa.dev/stable/lib/layout.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/layout.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/layout.min.css) |
| **`typography.css`** | ~15KB | ~10KB | ~8.6KB | ~1.6KB | ~1.3KB | [src](https://ucss.unqa.dev/stable/lib/typography.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/typography.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/typography.min.css) |
| **`components.css`** | ~50KB | ~45KB | ~40KB | ~6.5KB | ~5.6KB | [src](https://ucss.unqa.dev/stable/lib/components.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/components.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/components.min.css) |
| **`theming.css`** | ~17KB | ~15.6KB | ~14KB | ~3.3KB | ~2.8KB | [src](https://ucss.unqa.dev/stable/lib/theming.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/theming.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/theming.min.css) |
| **`utilities.css`** | ~10KB | ~7.3KB | ~6.2KB | ~1.1KB | ~0.9KB | [src](https://ucss.unqa.dev/stable/lib/utilities.css) ‚Ä¢ [clean](https://ucss.unqa.dev/stable/lib/utilities.clean.css) ‚Ä¢ [min](https://ucss.unqa.dev/stable/lib/utilities.min.css) |

> **Note**: These stats are for the **Full Framework**. If you cherry-pick modules or even single files (see [Modules](./lib/)), it is significantly smaller.

## The Manifest
The file `src/u.css` is the framework's entry point. It contains **zero** actual CSS. Its only job is to orchestrate the loading order of the modules.
*   **Order Matters**: We load `config` first (variables), then `base` (resets), then `layout` (structure), then `components`, then `utilities` (overrides).
*   **Validation**: If you remove `base` and don't apply .cs (clear spacing) class on your layout container, the components might look weird because they assume a certain reset baseline. If you remove `config`, everything keeps working based on fallback values.


---

## üì¶ Module Reference

### [Config](./lib/config/) (`root.css`)
The single source of truth. Contains **Design Tokens** for:
*   **Palette**: `--p` (Primary), `--a` (Accent), `--bg`, `--srf`.
*   **Typography**: `--t-fs-*` (Heading sizes), `--tx-fs-*` (Body sizes).
*   **Layout**: `--sc-max-w` (Max width), `--gap`.

### [Base](./lib/base/)
*   **`clear.css`**: Surgical reset. Removes default margins with `.cs` (Clean Spacing) class, with possibility to re-introduce nested content sections with `.csc` (Clean Spacing > Content) class. Use for design / app layouts with content sections that need to be nested in a design container. Removes ul and li default margin/padding/list-style with `.cl` (Clean List) class.

### [Layout](./lib/layout/)
*   **`section.css` (`.s`)**: The root container. Handles responsive padding and max-width constraints (`1366px` default).
*   **`grid.css` (`.g`)**: Auto-fit grids using `minmax()`. No "12 column" mental overhead unless you strictly need it.
*   **`flex.css` (`.f`)**: Modern flexbox utilities with variable-based keys.

### [Typography](./lib/typography/)
*   **`title.css` (`.t`)**: Fluid headings. Scales from mobile to desktop using `clamp()`.
*   **`text.css` (`.tx`)**: Body copy with optimal line-heights.

### [Components](./lib/components/)
*   **`card.css` (`.crd`)**: The "do everything" box. Composite architecture (`media`, `content`, `header`, `body`, `footer`).
*   **`button.css` (`.btn`)**: Interaction elements.
*   **`media.css` (`.med`)**: Aspect-ratio keepers.
*   **`link.css` (`.lnk`)**: The "Clickable Card" pattern solver.

### [Theming](./lib/theming/)
*   **`set.css` (`.set`)**: Contextual scopes. `.set.dark` inverts colors for that section and all its children.
*   **`overlay.css` (`.o`)**: Absolute positioning for background images/gradients.

### [Utilities](./lib/utilities/)
*   **`margin` (`.mg`)** / **`padding` (`.pd`)**: Spacing helpers using logical properties.
*   **`radius` (`.rad`)**: Consistent corner rounding.

---

## üõ†Ô∏è Maintainer Workflow

If you are contributing to uCss, here is how the magic happens.

### 1. The Build System
We use a **Node.js-based build system** (`scripts/build.js`) instead of a complex bundler like Webpack or Vite. Why? Because we only output CSS.
*   **Bundling**: Recursively resolves `@import` matching `src/lib`.
*   **Minification**: Regex-based optimized stripper. simpler and faster than cssnano for this specific architecture.
*   **Documentation**: Generates this static site from the Markdown files.

### 2. Commands
*   **`npm run build`**: Builds `src/` -> `dist/stable/` (or `latest` depending on branch).
*   **`./build.sh`**: Legacy shell wrapper (optional).

### 3. Release Channels
*   **Stable (`/stable/`)**: Production-ready. Use this for live sites. Automatically deployed from `main`.
*   **Latest (`/latest/`)**: Testing/Beta. Automatically deployed from `dev`.

### ‚ö° The "Great Build" Pipeline
We don't just copy files. Our `dist` assets go through a rigorous optimization pipeline to ensure maximum performance and compatibility:

1.  **Combining**: We flatten the cascade of `@import` statements into single-file bundles (like `u.css` or `layout.css`) to reduce HTTP requests.
2.  **Minification**: We strip all whitespace, comments, and redundant tokens using our own custom soft-minification script.
3.  **Compression**:
    *   **Gzip**: Standard compression, widely supported (~7x smaller).
    *   **Brotli**: Next-gen compression, best for modern browsers (~9x smaller).
4.  **Stable vs Latest**:
    *   `/stable`: Locked to the current major version. Safe for production.
    *   `/latest`: Bleeding edge. Good for testing new features.

---

## üöÄ Integration Snippets

For production usage, use the **Stable** channel.

### Full Framework
```html
<link rel="stylesheet" href="https://ucss.unqa.dev/stable/u.min.css">
<!-- Optional: Config Override -->
<link rel="stylesheet" href="https://ucss.unqa.dev/stable/lib/config/root.css">
```

### Optimization Tip (Preconnect)
Speed up connection time to our CDN:
```html
<link rel="preconnect" href="https://ucss.unqa.dev">
```

### Module-Only Import
If you *only* want the Grid system:
```html
<link rel="stylesheet" href="https://ucss.unqa.dev/stable/lib/layout/grid.min.css">
```
